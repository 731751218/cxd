(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"0602":function(t,e,a){"use strict";a.r(e);var n=a("cf57"),i=a("cda7");for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);a("a57f");var r=a("2877"),s=Object(r["a"])(i["default"],n["a"],n["b"],!1,null,null,null);e["default"]=s.exports},"494e":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(a("a34a")),i=o(a("b519"));function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){return u(t)||c(t,e)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function c(t,e){var a=[],n=!0,i=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done);n=!0)if(a.push(r.value),e&&a.length===e)break}catch(c){i=!0,o=c}finally{try{n||null==s["return"]||s["return"]()}finally{if(i)throw o}}return a}function u(t){if(Array.isArray(t))return t}function d(t,e,a,n,i,o,r){try{var s=t[o](r),c=s.value}catch(u){return void a(u)}s.done?e(c):Promise.resolve(c).then(n,i)}function l(t){return function(){var e=this,a=arguments;return new Promise(function(n,i){var o=t.apply(e,a);function r(t){d(o,n,i,r,s,"next",t)}function s(t){d(o,n,i,r,s,"throw",t)}r(void 0)})}}var p=function(){return a.e("components/lu-popup-wrapper/lu-popup-wrapper").then(a.bind(null,"0252"))},f={components:{luPopupWrapper:p},data:function(){return{top:"",swiperList:[],city:"未设置",amapPlugin:null,key:"",moduleList:[],latitude:"",longitude:"",cardticketList:[],isinfo:!0,name:"",phone:"",show:!0}},onShow:function(){var t=l(n.default.mark(function t(){return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.city=getApp().globalData.city;case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onLoad:function(){var e=l(n.default.mark(function e(a){var o,s,c,u,d,l,p,f,h,g,x,w,v,y,b,m,k=this;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return wx.getMenuButtonBoundingClientRect&&(o=wx.getMenuButtonBoundingClientRect().top,this.top=o),console.log("这是传的参数"+JSON.stringify(a)),e.next=4,this.ajax(this.api.swiperList);case 4:if(s=e.sent,200==s.data.code&&"null"!=s.data.data&&(this.swiperList=s.data.data),!a.scene){e.next=26;break}return c=decodeURIComponent(a.scene),getApp().globalData.pid=c,e.next=11,t.login({provider:"weixin"});case 11:return u=e.sent,d=r(u,2),d[0],l=d[1],e.next=17,this.ajax(this.api.login,{code:l.code},"POST");case 17:if(p=e.sent,200!=p.data.code){e.next=24;break}return t.setStorageSync("token",p.data.data),e.next=22,this.ajax(this.api.isinfo);case 22:f=e.sent,200==f.data.code&&(getApp().globalData.uid=f.data.data,this.isinfo=!1);case 24:e.next=37;break;case 26:return a.pid&&(getApp().globalData.pid=a.pid),e.next=29,t.login({provider:"weixin"});case 29:return h=e.sent,g=r(h,2),g[0],x=g[1],e.next=35,this.ajax(this.api.login,{code:x.code},"POST");case 35:w=e.sent,200==w.data.code&&t.setStorageSync("token",w.data.data);case 37:return e.next=39,this.ajax(this.api.isinfo);case 39:return v=e.sent,200==v.data.code&&(getApp().globalData.uid=v.data.data,this.isinfo=!1),e.next=43,this.ajax(this.api.mapkey);case 43:return y=e.sent,"null"!=y.data.data&&(this.key=y.data.data),t.showLoading({title:"加载中..."}),e.next=48,this.ajax(this.api.homeModule);case 48:return b=e.sent,t.hideLoading(),200==b.data.code?"null"!=b.data.data?this.moduleList=b.data.data:t.showToast({title:"暂无数据!",duration:2e3,icon:"none"}):t.showToast({title:"模块获取失败!",duration:2e3,icon:"none"}),e.next=53,this.ajax(this.api.cardticketList);case 53:m=e.sent,200==m.data.code&&"null"!=m.data.data&&(this.cardticketList=m.data.data),this.amapPlugin=new i.default.AMapWX({key:this.key}),this.amapPlugin.getRegeo({success:function(e){k.latitude=e[0].latitude,k.longitude=e[0].longitude,t.showToast({title:"默认城市:周口",duration:2e3,icon:"none"}),getApp().globalData.city="周口",k.city=getApp().globalData.city},fail:function(e){getApp().globalData.city="周口",k.city=getApp().globalData.city,t.showToast({title:"默认城市:周口",duration:2e3,icon:"none"})}});case 57:case"end":return e.stop()}},e,this)}));function a(t){return e.apply(this,arguments)}return a}(),onShareAppMessage:function(t){var e=getApp().globalData.uid;return{title:"分享小程序",path:"pages/index/index?pid=".concat(e)}},methods:{wxGetUserInfo:function(){var e=l(n.default.mark(function e(a){var i,o,s,c,u,d,l,p,f;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(i=this.name,o=this.phone,i=i.trim(),o=o.trim(),!i.length||11!=o.length){e.next=40;break}if(t.showLoading({title:"提交中...",mask:!0}),!a.detail.iv&&!a.detail.encryptedData){e.next=38;break}return e.next=8,t.login({provider:"weixin"});case 8:return s=e.sent,c=r(s,2),c[0],u=c[1],e.next=14,this.ajax(this.api.login,{code:u.code,iv:a.detail.iv,encryptedData:a.detail.encryptedData,pid:getApp().globalData.pid},"POST");case 14:if(d=e.sent,t.hideLoading(),200!=d.data.code){e.next=37;break}return t.setStorageSync("token",d.data.data),e.next=20,this.ajax(this.api.perfectuserinfo,{name:i,phone:o},"POST");case 20:if(l=e.sent,console.log(l),200!=l.data.code){e.next=35;break}return t.showToast({title:l.data.msg,duration:2e3,icon:"none"}),e.next=26,this.ajax(this.api.userinfo);case 26:return p=e.sent,200==p.data.code&&(getApp().globalData.userinfo=p.data.data),e.next=30,this.ajax(this.api.isinfo);case 30:f=e.sent,200==f.data.code&&(getApp().globalData.uid=f.data.data,console.log("获取到了用户的uid---------"+getApp().globalData.uid)),this.$refs.luPopupWrapper.close(),this.showtabbar(),this.isinfo=!1;case 35:e.next=38;break;case 37:t.showModal({title:"提示",content:d.data.msg,showCancel:!1});case 38:e.next=41;break;case 40:t.showToast({title:"请输入完整信息",duration:2e3,icon:"none"});case 41:case"end":return e.stop()}},e,this)}));function a(t){return e.apply(this,arguments)}return a}(),isinfoshow:function(){var e=l(n.default.mark(function e(){var a,i,o;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.hideTabBar({animation:!0});case 2:a=e.sent,i=r(a,2),o=i[0],i[1],o||this.$refs.luPopupWrapper.show();case 7:case"end":return e.stop()}},e,this)}));function a(){return e.apply(this,arguments)}return a}(),showtabbar:function(){var e=l(n.default.mark(function e(){var a,i;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log(1),e.next=3,t.showTabBar({animation:!0});case 3:a=e.sent,i=r(a,2),i[0],i[1];case 7:case"end":return e.stop()}},e,this)}));function a(){return e.apply(this,arguments)}return a}(),cardlink:function(e){console.log(e),t.navigateTo({url:"../shop/shop?id=".concat(e)})},swiperLink:function(e,a){1==e&&t.navigateTo({url:a})},link:function(e){t.navigateTo({url:e})},switchCity:function(){t.navigateTo({url:"../city/city?city=".concat(this.city)})},getPhoneNumber:function(){var e=l(n.default.mark(function e(a){var i,o,s,c;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.login({provider:"weixin"});case 2:if(i=e.sent,o=r(i,2),o[0],s=o[1],!a.detail.encryptedData||!a.detail.iv){e.next=12;break}return e.next=9,this.ajax(this.api.getPhone,{code:s.code,iv:a.detail.iv,encryptedData:a.detail.encryptedData},"POST");case 9:c=e.sent,console.log(c),200==c.data.code&&("null"!=c.data.data?(this.phone=c.data.data,this.show=!1):t.showToast({title:"获取手机号失败,请重试",duration:2e3,icon:"none"}));case 12:case"end":return e.stop()}},e,this)}));function a(t){return e.apply(this,arguments)}return a}(),phoneChange:function(t){console.log(t),t.detail.cursor>0?this.show=!1:this.show=!0}}};e.default=f}).call(this,a("543d")["default"])},"97cc":function(t,e,a){},a57f:function(t,e,a){"use strict";var n=a("97cc"),i=a.n(n);i.a},cda7:function(t,e,a){"use strict";a.r(e);var n=a("494e"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);e["default"]=i.a},cf57:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},i=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return i})},fa82:function(t,e,a){"use strict";(function(t){a("f103");n(a("66fd"));var e=n(a("0602"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])}},[["fa82","common/runtime","common/vendor"]]]);