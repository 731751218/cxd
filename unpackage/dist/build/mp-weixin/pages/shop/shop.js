(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shop/shop"],{"18e7":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("a34a")),r=i(n("f159"));function i(t){return t&&t.__esModule?t:{default:t}}function u(t,e){return c(t)||s(t,e)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function s(t,e){var n=[],a=!0,r=!1,i=void 0;try{for(var u,o=t[Symbol.iterator]();!(a=(u=o.next()).done);a=!0)if(n.push(u.value),e&&n.length===e)break}catch(s){r=!0,i=s}finally{try{a||null==o["return"]||o["return"]()}finally{if(r)throw i}}return n}function c(t){if(Array.isArray(t))return t}function d(t,e,n,a,r,i,u){try{var o=t[i](u),s=o.value}catch(c){return void n(c)}o.done?e(s):Promise.resolve(s).then(a,r)}function f(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var i=t.apply(e,n);function u(t){d(i,a,r,u,o,"next",t)}function o(t){d(i,a,r,u,o,"throw",t)}u(void 0)})}}var l=function(){return n.e("components/lu-popup-wrapper/lu-popup-wrapper").then(n.bind(null,"0252"))},p=function(){return n.e("components/an-layer/an-layer").then(n.bind(null,"da0f"))},h=function(){return n.e("components/uni-number-box/uni-number-box").then(n.bind(null,"3aa6"))},m={components:{luPopupWrapper:l,uniNumberBox:h,anLayer:p},data:function(){return{num:1,settime:null,info:{},text:"<p>你好</p",isIphoneX:!1}},onLoad:function(){var e=f(a.default.mark(function e(n){var r,i,o,s,c,d,f,l;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=getApp().globalData.isIphoneX,this.isIphoneX=r,!n.id){e.next=18;break}return t.showLoading({title:"加载中..",mask:!0}),e.next=6,t.getLocation({type:"gcj02"});case 6:return i=e.sent,o=u(i,2),s=o[0],c=o[1],d="",f="",s?(d=null,f=null):(d=c.longitude,f=c.latitude),e.next=15,this.ajax(this.api.cardTicket,{id:n.id,longitude:d,latitude:f},"POST");case 15:l=e.sent,t.hideLoading(),200==l.data.code&&(this.info=l.data.data,t.setNavigationBarTitle({title:l.data.data.card_name}));case 18:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),methods:{pay:function(){var e=f(a.default.mark(function e(){var n,i,u,o,s,c,d,l,p,h,m,v=this;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=this.info,i=n.card_id,u=n.id,o=n.price,s=this.num,t.showLoading({title:"支付中..",mask:!0}),e.next=5,this.ajax(this.api.cardTicketPay,{card_ticket_id:i,id:u,num:s,price:o},"POST");case 5:c=e.sent,t.hideLoading(),200==c.data.code?(d=res.data.data.appid,l=parseFloat(res.data.data.timeStamp).toString(),p="prepay_id="+res.data.data.prepay_id,h=res.data.data.nonce_str,res.data.data.sign,m=r.default.MD5("appId="+d+"&nonceStr="+h+"&package="+p+"&signType=MD5&timeStamp="+l+"&key="+res.data.data.apikey),t.requestPayment({provider:"wxpay",timeStamp:l,nonceStr:h,package:p,signType:"MD5",paySign:m,success:function(e){v.$refs.anRef.show("支付成功！",{type:"success"}),setTimeout(function(){t.navigateTo({url:"../shopOrder/shopOrder"})},1e3)},fail:function(){var t=f(a.default.mark(function t(e){return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:v.$refs.anRef.show("支付失败！",{type:"error"}),v.ajax(v.api.recoveryStock,{id:u,num:s},"POST");case 2:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()})):201==c.data.code?(this.$refs.anRef.show("支付成功！",{type:"success"}),this.settime=setTimeout(function(){t.navigateTo({url:"../shopOrder/shopOrder"})},1e3)):this.$refs.anRef.show(c.data.msg,{type:"success"});case 8:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),callphone:function(){t.makePhoneCall({phoneNumber:this.info.phone})},openMap:function(){t.openLocation({latitude:Number(this.info.latitude),longitude:Number(this.info.longitude),name:this.info.shop_name})},numChange:function(t){this.num=t},swiperLink:function(e){t.previewImage({current:e,urls:this.info.swiper})}},onUnload:function(){clearTimeout(this.settime)}};e.default=m}).call(this,n("543d")["default"])},"2a26":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},r=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return r})},"2d13":function(t,e,n){"use strict";var a=n("944f"),r=n.n(a);r.a},"4f90":function(t,e,n){"use strict";(function(t){n("f103");a(n("66fd"));var e=a(n("63a1"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"63a1":function(t,e,n){"use strict";n.r(e);var a=n("2a26"),r=n("ec0b");for(var i in r)"default"!==i&&function(t){n.d(e,t,function(){return r[t]})}(i);n("2d13");var u=n("2877"),o=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,null,null);e["default"]=o.exports},"944f":function(t,e,n){},ec0b:function(t,e,n){"use strict";n.r(e);var a=n("18e7"),r=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,function(){return a[t]})}(i);e["default"]=r.a}},[["4f90","common/runtime","common/vendor"]]]);