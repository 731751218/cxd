(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/exemptionLabel/exemptionLabel"],{"0a8d":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},a=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a})},7456:function(e,t,i){},"7ef2":function(e,t,i){"use strict";var n=i("7456"),a=i.n(n);a.a},"82e6":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(i("a34a")),a=s(i("f159"));function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){return c(e)||u(e,t)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function u(e,t){var i=[],n=!0,a=!1,s=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done);n=!0)if(i.push(r.value),t&&i.length===t)break}catch(u){a=!0,s=u}finally{try{n||null==o["return"]||o["return"]()}finally{if(a)throw s}}return i}function c(e){if(Array.isArray(e))return e}function l(e,t,i,n,a,s,r){try{var o=e[s](r),u=o.value}catch(c){return void i(c)}o.done?t(u):Promise.resolve(u).then(n,a)}function d(e){return function(){var t=this,i=arguments;return new Promise(function(n,a){var s=e.apply(t,i);function r(e){l(s,n,a,r,o,"next",e)}function o(e){l(s,n,a,r,o,"throw",e)}r(void 0)})}}var h=function(){return i.e("components/license-plate-key").then(i.bind(null,"1f92"))},p={components:{licensePlateKey:h},data:function(){return{drivinglicensejust:"",drivinglicensejustimg:"",drivinglicensevice:"",drivinglicenseviceimg:"",insurance:"",insuranceimg:"",carnumber:"",distinguishres:{},name:"",phone:"",address:"",msg:"",settime:null,exemptionLabelPrice:""}},onLoad:function(){var e=d(n.default.mark(function e(){var t;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.ajax(this.api.exemptionLabelPrice);case 2:t=e.sent,200==t.data.code&&(this.exemptionLabelPrice=t.data.data);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{deleteimg:function(e){switch(e){case 1:this.drivinglicensejust="",this.drivinglicensejustimg="";break;case 2:this.drivinglicensevice="",this.drivinglicenseviceimg="";break;case 3:this.insurance="",this.insuranceimg="";break}},lookImg:function(t){var i="";switch(t){case 1:i=this.drivinglicensejustimg;break;case 2:i=this.drivinglicenseviceimg;break;case 3:i=this.insuranceimg;break}var n=[i];e.previewImage({urls:n,longPressActions:{itemList:["发送给朋友","保存图片","收藏"]}})},getaddress:function(){var t=d(n.default.mark(function t(){var i,a,s,o,u,c,l;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.chooseAddress();case 2:i=t.sent,a=r(i,2),s=a[0],o=a[1],s?e.showToast({title:"获取通信地址失败",icon:"none",duration:2e3}):(u=o.provinceName+o.cityName+o.countyName+o.detailInfo,c=o.userName,l=o.telNumber,this.name=c,this.phone=l,this.address=u);case 7:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),uploadFileJust:function(){var t=d(n.default.mark(function t(){var i,a,s,o,u,c,l,d,h,p,f,g,m,v,b,y,w,x,_,k,T;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"]});case 2:if(i=t.sent,a=r(i,2),s=a[0],o=a[1],s){t.next=26;break}return this.drivinglicensejustimg=o.tempFilePaths[0],t.next=10,e.uploadFile({url:this.api.uplode_img,filePath:o.tempFilePaths[0],name:"img"});case 10:if(u=t.sent,c=r(u,2),l=c[0],d=c[1],l){t.next=25;break}return h=JSON.parse(d.data),console.log(h),this.drivinglicensejust=h.url,console.log(this.drivinglicensejust),t.next=21,this.ajax(this.api.distinguish,{img:h.url},"POST");case 21:p=t.sent,200==p.data.code?(f=p.data.data,g=f.addr,m=f.engine_num,v=f.issue_date,b=f.model,y=f.owner,w=f.plate_num,x=f.register_date,_=f.use_character,k=f.vehicle_type,T=f.vin,this.distinguishres.addr=g,this.distinguishres.engine_num=m,this.distinguishres.issue_date=v,this.distinguishres.model=b,this.distinguishres.owner=y,this.distinguishres.plate_num=w,this.distinguishres.register_date=x,this.distinguishres.use_character=_,this.distinguishres.vehicle_type=k,this.distinguishres.vin=T):e.showToast({title:"智能识别失败",duration:2e3,icon:"none"}),t.next=26;break;case 25:e.showToast({title:"上传失败",duration:2e3,icon:"none"});case 26:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),uploadFileVice:function(){var t=d(n.default.mark(function t(){var i,a,s,o,u,c,l,d,h,p,f,g,m,v,b,y;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"]});case 2:if(i=t.sent,a=r(i,2),s=a[0],o=a[1],s){t.next=24;break}return this.drivinglicenseviceimg=o.tempFilePaths[0],t.next=10,e.uploadFile({url:this.api.uplode_img,filePath:o.tempFilePaths[0],name:"img"});case 10:if(u=t.sent,c=r(u,2),l=c[0],d=c[1],l){t.next=23;break}return h=JSON.parse(d.data),this.drivinglicensevice=h.url,t.next=19,this.ajax(this.api.distinguish,{img:h.url},"POST");case 19:p=t.sent,200==p.data.code?(f=p.data.data,g=f.plate_num_b,m=f.prepare_quality,v=f.record,b=f.total_quality,y=f.passengers_num,this.distinguishres.plate_num_b=g,this.distinguishres.passengers_num=y,this.distinguishres.prepare_quality=m,this.distinguishres.record=v,this.distinguishres.total_quality=b):e.showToast({title:"智能识别失败",duration:2e3,icon:"none"}),t.next=24;break;case 23:e.showToast({title:"上传失败",duration:2e3,icon:"none"});case 24:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),uploadFileInsurance:function(){var t=d(n.default.mark(function t(){var i,a,s,o,u,c,l,d,h;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"]});case 2:if(i=t.sent,a=r(i,2),s=a[0],o=a[1],s){t.next=15;break}return this.insuranceimg=o.tempFilePaths[0],t.next=10,e.uploadFile({url:this.api.uplode_img,filePath:o.tempFilePaths[0],name:"img"});case 10:u=t.sent,c=r(u,2),l=c[0],d=c[1],l?e.showToast({title:"上传失败",duration:2e3,icon:"none"}):(h=JSON.parse(d.data),this.insurance=h.url);case 15:case"end":return t.stop()}},t,this)}));function i(){return t.apply(this,arguments)}return i}(),previewPictures:function(t){var i="";switch(t){case 1:i=getApp().globalData.example.driving_license_just;break;case 2:i=getApp().globalData.example.driving_license_vice;break;case 3:i=getApp().globalData.example.insurance_img;break}e.previewImage({urls:[i],longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(e){console.log("选中了第"+(e.tapIndex+1)+"个按钮,第"+(e.index+1)+"张图片")},fail:function(e){console.log(e.errMsg)}}})},submit:function(){var t=this,i=this.$refs.licensePlateKey.toBind();if(!i)return e.showToast({title:"请填写车牌号信息",duration:2e3,icon:"none"}),!1;this.carnumber=i;var n=this.drivinglicensejust,s=this.drivinglicensevice,r=this.insurance,o=this.distinguishres,u=this.name,c=this.phone,l=this.address,d=this.exemptionLabelPrice,h=this.msg;if(!d)return e.showToast({title:"免检标订单金额错误!",duration:2e3,icon:"none"}),!1;if(i.length<7)return e.showToast({title:"请填写完整的车牌号信息",duration:2e3,icon:"none"}),!1;if(!n.length)return e.showToast({title:"请上传行驶证正页",duration:2e3,icon:"none"}),!1;if(!s.length)return e.showToast({title:"请上传行驶证副页",duration:2e3,icon:"none"}),!1;if(!r.length)return e.showToast({title:"请上传保险单",duration:2e3,icon:"none"}),!1;if(!u.length)return e.showToast({title:"请填写收件人姓名",duration:2e3,icon:"none"}),!1;if(!c.length)return e.showToast({title:"请填写收件人联系方式",duration:2e3,icon:"none"}),!1;if(!l.length)return e.showToast({title:"请填写收货地址",duration:2e3,icon:"none"}),!1;var p=this.ajax(this.api.exemptionMarkPay,{carnumber:i,drivinglicensejust:n,drivinglicensevice:s,insurance:r,distinguishres:o,name:u,phone:c,address:l,msg:h,price:d},"POST");if(200==p.data.code){var f=p.data.data.payinfo.appid,g=parseFloat(p.data.data.payinfo.timeStamp).toString(),m="prepay_id="+p.data.data.payinfo.prepay_id,v=p.data.data.payinfo.nonce_str,b=(p.data.data.payinfo.sign,a.default.MD5("appId="+f+"&nonceStr="+v+"&package="+m+"&signType=MD5&timeStamp="+g+"&key="+p.data.data.payinfo.apikey));e.requestPayment({provider:"wxpay",timeStamp:g,nonceStr:v,package:m,signType:"MD5",paySign:b,success:function(i){t.settime=setTimeout(function(){e.reLaunch({url:"../index/index"})},1e3)},fail:function(e){console.log("支付失败")},complete:function(){}})}}},onUnload:function(){clearTimeout(this.settime)}};t.default=p}).call(this,i("543d")["default"])},a666:function(e,t,i){"use strict";(function(e){i("f103");n(i("66fd"));var t=n(i("bf3a"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])},bf3a:function(e,t,i){"use strict";i.r(t);var n=i("0a8d"),a=i("ecfe");for(var s in a)"default"!==s&&function(e){i.d(t,e,function(){return a[e]})}(s);i("7ef2");var r=i("2877"),o=Object(r["a"])(a["default"],n["a"],n["b"],!1,null,null,null);t["default"]=o.exports},ecfe:function(e,t,i){"use strict";i.r(t);var n=i("82e6"),a=i.n(n);for(var s in n)"default"!==s&&function(e){i.d(t,e,function(){return n[e]})}(s);t["default"]=a.a}},[["a666","common/runtime","common/vendor"]]]);